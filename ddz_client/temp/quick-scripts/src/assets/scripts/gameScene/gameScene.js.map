{"version":3,"sources":["assets/scripts/gameScene/gameScene.js"],"names":["cc","Class","Component","properties","di_label","Label","beishu_label","roomid_label","player_node_prefabs","Prefab","players_seat_pos","Node","gameEnd","console","log","recovery_game","myglobal","socket","request_recovery","err","result","JSON","stringify","ResetUI_with_data","bind","data","roomstate","state","gameingUI","node","getChildByName","active","RoomState","ROOM_PLAYING","gameingUI_script","getComponent","ResetUI_","gamebeforeUI","emit","_cards","length","show_mycards","three_cards","show_bottom_cards","cur_waitchucard","now_whocan_chupai","last_push_card_accountid","show_chupai","last_push_card_list","returnback","ROOM_GAMESTART","Alert","show","leaveroom","director","loadScene","requestLeaveRoom","onDestroy","_event","removeAllLister","onLoad","that","playerNodeList","playerdata_list","string","playerData","bottom","rate","ROOM_INVALID","on","i","onRoomChangeState","onPlayerDisconnect","accountid","Toast","deletePlayerNode","accountID","onPlayerDisonline","offlinePlayerNode","onPlayerReonline","onlinePlayerNode","onSocketClosed","onNotLogined","event","gameui_node","request_enter_room","seatid","seatindex","playerdata_list_pos","playerdata","roomid","housemanageid","seat_index","addPlayerNode","isopen_sound","audioEngine","stopAll","play","url","raw","onPlayerJoinRoom","join_playerdata","onPlayerReady","onGameStart","onRobState","onChangeMaster","master_accountid","onShowBottomCard","onUpdateinfo","updateGold","infolist","player_data","playernode_inst","instantiate","parent","index","position","children","init_data","push","p","j","removeFromParent","destroy","splice","getPlayerNodeByAccountid","_this","onOffLine","onOnLine","getUserOutCardPosByAccount","node_script","seat_node","index_name","out_card_node"],"mappings":"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","sourceRoot":"/","sourcesContent":["import myglobal from \"../mygolbal.js\"\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        di_label:cc.Label,\n        beishu_label:cc.Label,\n        roomid_label:cc.Label,\n        player_node_prefabs:cc.Prefab,\n        //绑定玩家座位,下面有3个子节点\n        players_seat_pos:cc.Node,\n        \n    },\n    //本局结束，做状态清除\n    gameEnd(){\n       console.log(\"本局结束,做 状态 清除\")\n    },\n\trecovery_game(){\n\t\tmyglobal.socket.request_recovery({},function(err,result){//尝试 恢复牌局\n\t\t    console.log(\"request_recovery_resp\"+ JSON.stringify(result))\n\t\t\t//Toast.show(JSON.stringify(result));\n\t\t    if(err!=0){\n\t\t       console.log(\"request_recovery_resp err:\"+err)\n\t\t    }else{\n\t\t\t\n\t        this.ResetUI_with_data(result);\t\n\t\t\t\t\n\t\t\t}\n\t\t}.bind(this));\n\t},\n\tResetUI_with_data(data){\n\t\tthis.roomstate=data.state;\n\t\t\n\t\tvar gameingUI=this.node.getChildByName(\"gameingUI\");\n\t\t\t\t\t\tgameingUI.active=(this.roomstate==RoomState.ROOM_PLAYING?true:false);\n\t\tvar gameingUI_script= this.node.getChildByName(\"gameingUI\").getComponent(\"gameingUI\");\n\t\tgameingUI_script.ResetUI_()\n\t\t\n\t\t\n\t\t\tvar gamebeforeUI = this.node.getChildByName(\"gamebeforeUI\")\n\t\t\t    if(this.roomstate==RoomState.ROOM_PLAYING){//游戏中\n\t\t\t\t    gamebeforeUI.active=false;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t        gamebeforeUI.active = this.roomstate==RoomState.ROOM_PLAYING? false:true\n\t\t\t        gamebeforeUI.emit(\"init\")\n\t\t\t\t}\n\t\t\n\t\t if(this.roomstate==RoomState.ROOM_PLAYING){// 游戏中\n\t\t   if(typeof(data._cards)!=\"undefined\"&&data._cards.length>0){//显示手牌\n\t\t      gameingUI_script.show_mycards(data._cards);\n\t\t   }\n\t\t   if(typeof(data.three_cards)!=\"undefined\"&&data.three_cards.length>0){//显示地主牌\n\t\t       gameingUI_script.show_bottom_cards(data.three_cards)  \n\t\t   }\n\t\t   if(typeof(data.cur_waitchucard)!=\"undefined\"){//当前谁出牌\n\t\t     gameingUI_script.now_whocan_chupai(data.cur_waitchucard);\n\t\t   }\n\t\t   if(typeof(data.last_push_card_accountid)!=\"undefined\"){//上次出的非空牌\n\t\t\t   gameingUI_script.show_chupai({\"accountid\":data.last_push_card_accountid,\"cards\":data.last_push_card_list});\n\t\t   }\n\t\t   \n\t\t  }\n\t\t   \n\t\t   \n\t},\n\t\n\treturnback(){//返回上一页\n\t\t\n\t\t\n\t\t//cc.director.loadScene(\"hallScene\")\n\t\t\n\t\tif(this.roomstate>=RoomState.ROOM_GAMESTART){\n\t\t\t Alert.show(\"游戏进行中,确定离开吗\",function(){\n\t\t\t\t this.leaveroom()\n\t\t\t }.bind(this)); \n\t\t}else{\n\t\t// \t//离开房间\n\t\t \tthis.leaveroom();\n\t\t}\t\n\t},\n\tleaveroom(){// 离开房间\n\t   cc.director.loadScene(\"hallScene\")\n\t   myglobal.socket.requestLeaveRoom();\n\t},\n\t// onLoad(){\n\t\t\n\t// },\n\tonDestroy(){\n\t   myglobal.socket._event.removeAllLister();\t\n\t},\n    onLoad () {\n\t\tvar that=this;\n        this.playerNodeList = []\n\t\tthis.playerdata_list=[]\n        this.di_label.string = \"底:\" +  myglobal.playerData.bottom\n        this.beishu_label.string = \"倍数:\" + myglobal.playerData.rate\n        this.roomstate = RoomState.ROOM_INVALID\n        //监听，给其他玩家发牌(内部事件)\n        this.node.on(\"pushcard_other_event\",function(){\n            console.log(\"gamescene pushcard_other_event\")\n            for(var i=0;i<that.playerNodeList.length;i++){\n                    var node = that.playerNodeList[i]\n                    if(node){\n                    //给playernode节点发送事件\n                        node.emit(\"push_card_event\")\n                    }\n            }\n        }.bind(this))\n\n        //监听房间状态改变事件\n        myglobal.socket.onRoomChangeState(function(data){\n            //回调的函数参数是进入房间用户消息\n            console.log(\"onRoomChangeState:\"+data)\n            that.roomstate = data\n\t\t\tif(that.roomstate==RoomState.ROOM_INVALID){//\n\t\t\t//重置游戏\n\t\t\t\tconsole.log(\"服务器 重置 游戏\");\n\t\t\t\t//var gamebefore_node = this.node.getChildByName(\"gameingUI\")\n\t\t\t\tthat.node.getChildByName(\"gameingUI\").getComponent(\"gameingUI\").ResetUI_()\n\n\t\t\t\t//gamebefore_node.emit(\"init\")\n\t\t\t\t\n\t\t\t}\n        }.bind(this))\n\t\t\n\t\tmyglobal.socket.onPlayerDisconnect(function(data){\n\t\t\tconsole.log(\"onPlayerDisconnect 玩家离开房间:\"+data.accountid+\" \") //某个玩家离开房间\n\t\t\tToast.show(data.accountid+\" 离开房间\");\n\t\n\t\t\tthat.deletePlayerNode(data);\n\t        if(data.accountid==myglobal.playerData.accountID){\n\t\t\t\tconsole.log(\"您被踢出房间\")\n\t\t\t\tcc.director.loadScene(\"hallScene\")\n\t\t\t}\t\t\n\t\t}.bind(this));\n\t\tmyglobal.socket.onPlayerDisonline(function(data){\n\t\t\tconsole.log(\"onPlayerDisonline 玩家掉线:\"+data.accountid+\" \") //某个玩家 游戏中掉线\n\t\t\tthat.offlinePlayerNode(data);\n\t\t}.bind(this));\n\t\tmyglobal.socket.onPlayerReonline(function(data){\n\t\t\tconsole.log(\"onPlayerReonline 玩家重新连接成功:\"+data.accountid+\" \") //某个玩家 游戏中掉线重连成功通知\n\t\t\tthat.onlinePlayerNode(data);\n\t\t}.bind(this));\n\t\t\n\t  \n\t\t \n\t\t \n        //\n\t\tmyglobal.socket.onSocketClosed(function(data){\n\t\t\tconsole.log(\"onSocketClosed:\"+data)\n\t\t\t Alert.show(\"您掉线啦,请重新登录!\",function(){\n\t\t\t\t cc.director.loadScene(\"loginScene\");\n\t\t\t\t return;\n\t\t\t\t // if(this.roomstate!=RoomState.ROOM_PLAYING){\n\t\t\t\t // \t\t  cc.director.loadScene(\"loginScene\");\n\t\t\t\t // \t\t  return;\n\t\t\t\t // }\n\t\t\t\t \t\n\t\t\t\t // var node=this.node.getChildByName(\"gameingUI\").getComponent(\"gameingUI\");\n\t\t\t\t // \tnode.returnroom.active=true;\n\t\t\t\t \t\n\t\t\t\t \t\n\t\t\t\t },false);\n\t\t\t\t \n\t\t}.bind(this));\n\t\t\t\n\t\tmyglobal.socket.onNotLogined(function(data){\n\t\t\tconsole.log(\"您未登录!\")\n\t\t\tAlert.show(\"您未登录,请重新登录!\",function(){\n\t\t\t\tcc.director.loadScene(\"loginScene\");\n\t\t\t})\n\t\t}.bind(this));\n\t\t\t\n\t\t\n\t\n\t\t\n\t\t\n\t\tthis.node.on(\"onCanChuCard_gameScene\",function(data){\n\t\t\tconsole.log(\"等待玩家出牌 \",JSON.stringify(data));\n\t\t\t//通知 可以出牌\n\t\t\tfor(var i=0;i<that.playerNodeList.length;i++){\n\t\t\t    var node = that.playerNodeList[i]\n\t\t\t    if(node){\n\t\t\t\t\tnode.emit(\"onCanChuCard_playernode\",data);\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this));\n        this.node.on(\"canrob_event\",function(event){\n            console.log(\"gamescene canrob_event:\"+event)\n            //通知给playernode子节点\n            for(var i=0;i<that.playerNodeList.length;i++){\n                var node = that.playerNodeList[i]\n                if(node){\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_canrob_event\",event)\n                }\n            }\n        }.bind(this))\n\t\t\n\n        this.node.on(\"choose_card_event\",function(event){\n            console.log(\"--------choose_card_event-----------\")\n            var gameui_node =  this.node.getChildByName(\"gameingUI\")\n            if(gameui_node==null){\n               console.log(\"get childer name gameingUI\")\n               return\n            }\n            gameui_node.emit(\"choose_card_event\",event)\n           \n        }.bind(this))\n\n        this.node.on(\"unchoose_card_event\",function(event){\n            console.log(\"--------unchoose_card_event-----------\")\n            var gameui_node =  this.node.getChildByName(\"gameingUI\")\n            if(gameui_node==null){\n               console.log(\"get childer name gameingUI\")\n               return\n            }\n            gameui_node.emit(\"unchoose_card_event\",event)\n        }.bind(this))\n        //监听给玩家添加三张底牌\n        // this.node.on(\"add_three_card\",function(event){\n        //     console.log(\"add_three_card:\"+event)\n        //     for(var i=0;i<this.playerNodeList.length;i++){\n        //         var node = this.playerNodeList[i]\n        //         if(node){\n        //             //给playernode节点发送事件\n        //             node.emit(\"playernode_add_three_card\",event)\n        //         }\n        //     }\n        // }.bind(this))\n\n        myglobal.socket.request_enter_room({},function(err,result){\n            console.log(\"enter_room_resp\"+ JSON.stringify(result))\n            if(err!=0){\n               console.log(\"enter_room_resp err:\"+err)\n            }else{\n             \n              //enter_room成功\n              //notify ={\"seatid\":1,\"playerdata\":[{\"accountid\":\"2117836\",\"nick_name\":\"tiny543\",\"avatarUrl\":\"http://xxx\",\"goldcount\":1000}]}\n                var seatid = result.seatindex //自己在房间里的seatid\n                that.playerdata_list_pos = []  //3个用户创建一个空用户列表\n                //this.setPlayerSeatPos(seatid)\n\n                var playerdata_list = result.playerdata\n                var roomid = result.roomid\n\t\t\t\tthat.roomid=result.roomid\n                that.roomid_label.string = \"房间号:\" + roomid\n                myglobal.playerData.housemanageid = result.housemanageid\n                myglobal.playerData.seat_index=seatid;\n                for(var i=0;i<playerdata_list.length;i++){\n                    //consol.log(\"this----\"+this)\n                    that.addPlayerNode(playerdata_list[i])\n                }\n\n                if(isopen_sound){\n                    cc.audioEngine.stopAll()\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/bg.mp3\"),true) \n                }\n            }\n           // var gamebefore_node = this.node.getChildByName(\"gamebeforeUI\")\n            //gamebefore_node.emit(\"init\")\n\t\t\t\n\t\t\t//this.node.getChildByName(\"gameingUI\").getComponent(\"gameingUI\").ResetUI_()\n\t\t\t\n\t\t\t\n\t\t\tthat.recovery_game();\n\t\t\t\n        }.bind(this))\n\n        //在进入房间后，注册其他玩家进入房间的事件\n        myglobal.socket.onPlayerJoinRoom(function(join_playerdata){\n            //回调的函数参数是进入房间用户消息\n            console.log(\"onPlayerJoinRoom:\"+JSON.stringify(join_playerdata))\n            Toast.show(join_playerdata.accountid+\" 进入房间\");\n\t\t\tthat.addPlayerNode(join_playerdata)\n        }.bind(this))\n        \n        //回调参数是发送准备消息的accountid\n        myglobal.socket.onPlayerReady(function(data){\n            console.log(\"-------onPlayerReady:\"+data)\n            for(var i=0;i<that.playerNodeList.length;i++){\n                var node = that.playerNodeList[i]\n                if(node){\n                    node.emit(\"player_ready_notify\",data)\n                }\n            }\n        })\n\n        myglobal.socket.onGameStart(function(){\n            for(var i=0;i<that.playerNodeList.length;i++){\n                var node = that.playerNodeList[i]\n                if(node){\n                    node.emit(\"gamestart_event\")\n                }\n            }\n\n        //隐藏gamebeforeUI节点\n        var gamebeforeUI = this.node.getChildByName(\"gamebeforeUI\")\n            if(gamebeforeUI){\n                gamebeforeUI.active = false\n            }\n        }.bind(this))\n\n              //监听服务器玩家抢地主消息\n        myglobal.socket.onRobState(function(event){\n                console.log(\"-----onRobState\"+JSON.stringify(event))\n                //onRobState{\"accountid\":\"2162866\",\"state\":1}\n                for(var i=0;i<that.playerNodeList.length;i++){\n                    var node = that.playerNodeList[i]\n                    if(node){\n                        //给playernode节点发送事件\n                        node.emit(\"playernode_rob_state_event\",event)\n                    }\n                }\n        }.bind(this))\n\n        //注册监听服务器确定地主消息\n        myglobal.socket.onChangeMaster(function(event){\n            console.log(\"onChangeMaster\"+event)\n            //保存一下地主id\n            myglobal.playerData.master_accountid = event\n            for(var i=0;i<that.playerNodeList.length;i++){\n                var node = that.playerNodeList[i]\n                if(node){\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_changemaster_event\",event)\n                }\n            }\n        }.bind(this))\n        \n        //注册监听服务器显示底牌消息\n        myglobal.socket.onShowBottomCard(function(event){\n           console.log(\"onShowBottomCard---------\"+event)\n           var gameui_node =  this.node.getChildByName(\"gameingUI\")\n           if(gameui_node==null){\n              console.log(\"get childer name gameingUI\")\n              return\n           }\n           gameui_node.emit(\"show_bottom_card_event\",event)\n        }.bind(this))\n\t\t\n\t\t//更新玩家分数\n\t\tmyglobal.socket.onUpdateinfo(function(event){\n\t\t\t\n\t\t\tfor(var i=0;i< this.playerNodeList.length;i++){\n\t\t\t\tthis.playerNodeList[i].getComponent(\"player_node\").updateGold(event.infolist)\n\t\t\t}\n\t\t\t\n\t\t}.bind(this));\n\t\t\n\t\t\n    },\n\n    //seat_index自己在房间的位置id\n    // setPlayerSeatPos(seat_index){\n    //     if(seat_index < 1 || seat_index > 3){\n    //         console.log(\"seat_index error\"+seat_index)\n    //         return\n    //     }\n\n    //     console.log(\"setPlayerSeatPos seat_index:\" + seat_index)\n       \n    //     //界面位置转化成逻辑位置\n    //     switch(seat_index){\n    //         case 1:\n    //                this.playerdata_list_pos[1] = 0\n    //                this.playerdata_list_pos[2] = 1 \n    //                this.playerdata_list_pos[3] = 2\n    //           break\n    //          case 2:\n                   \n\n    //                 this.playerdata_list_pos[2] = 0\n    //                 this.playerdata_list_pos[3] = 1\n    //                 this.playerdata_list_pos[1] = 2\n    //                 break\n    //          case 3:\n    //                 this.playerdata_list_pos[3] = 0     \n    //                 this.playerdata_list_pos[2] = 1\n    //                 this.playerdata_list_pos[1] = 2\n    //                 break\n    //         default: \n    //           break      \n    //     } \n\n    // },\n\n    addPlayerNode(player_data){\n        var playernode_inst = cc.instantiate(this.player_node_prefabs)\n        playernode_inst.parent = this.node\n      \n         \n        //玩家在room里的位置索引(逻辑位置)\n        var index = (player_data.seatindex+3-myglobal.playerData.seat_index)%3;//     this.playerdata_list_pos[player_data.seatindex]\n        console.log(\"我座位号\"+myglobal.playerData.seat_index+\" ,玩家座位号\"+player_data.seatindex+ \" \"+index)\n        playernode_inst.position = this.players_seat_pos.children[index].position\n        playernode_inst.getComponent(\"player_node\").init_data(player_data,index)\n\t\t//创建的节点存储在gamescene的列表中\n\t\tthis.playerNodeList.push(playernode_inst) \n    },\n\tdeletePlayerNode(p){//某个玩家 离开房间\n\t\t // const _this=this;\n\t      for(var i=0;i<this.playerNodeList.length;i++){\n\t\t\t  console.log(\"is delete \"+this.playerNodeList[i].getComponent(\"player_node\").accountid+\":\"+p.accountid);\n\t\t\t  if(this.playerNodeList[i].getComponent(\"player_node\").accountid==p.accountid){\n\t\t\t\t  console.log(\"delete \"+i+\":\"+p.accountid);\n\t\t\t\t      var j=i;\n\t\t\t\t\t  // setTimeout(function () {\n\t\t\t\t        this.playerNodeList[j].removeFromParent();\n\t\t\t\t        this.playerNodeList[j].destroy();\n\t\t\t\t        // delete(_this.playerNodeList[j]);\n\t\t\t\t\t\t//this.playerNodeList[j].removeListener();\n\t\t\t\t\t\tthis.playerNodeList.splice(j,1);\n\t\t\t\t      // }.bind(this),100);\n\t\t\t\t  \n\t\t\t  }\n\t\t  }\n\t\t\n\t},\n\tgetPlayerNodeByAccountid(accountid){\n\t\tconst _this=this;\n\t\tfor(var i=0;i<_this.playerNodeList.length;i++){\n\t\t\t\t\t//  console.log(\"is delete \"+_this.playerNodeList[i].getComponent(\"player_node\").accountid+\":\"+accountid);\n\t\t    if(_this.playerNodeList[i].getComponent(\"player_node\").accountid==accountid){\n\t\t\t\treturn _this.playerNodeList[i];\n\t\t\t}\n\t\t}\n\t},\n\tofflinePlayerNode(p){//某个玩家 游戏中掉线\n\t\tconst _this=this;\n\t\t var node= _this.getPlayerNodeByAccountid(p.accountid);\n\t\t node.getComponent(\"player_node\").onOffLine();\n\t\t// for(var i=0;i<_this.playerdata_list.length;i++){\n\t\t//   if(_this.playerdata_list[i].accountid==p.accountid){\n\t\t// \t  _this.playerNodeList[i].getComponent(\"player_node\").onOffLine();\n\t\t//   }\n\t\t// }\n\t},\n\tonlinePlayerNode(p){//某个玩家 游戏中掉线重新连接成功\n\t\tconst _this=this;\n\t\t// for(var i=0;i<_this.playerdata_list.length;i++){//\n\t\t//   if(_this.playerdata_list[i].accountid==p.accountid){\n\t\t// \t  _this.playerNodeList[i].getComponent(\"player_node\").onOnLine();\n\t\t//   }\n\t\t// }\n\t\tvar node= _this.getPlayerNodeByAccountid(p.accountid);\n\t\tnode.getComponent(\"player_node\").onOnLine();\n\t\t\n\t\tif(p.accountid==myglobal.playerData.accountID){// 自己掉线重连成功\n\t\t  //获取 手牌 和 房间最新状态   \n\t\t  //手牌  房间状态  当前到谁出牌, 上次玩家 出牌是什么  出牌剩余时间  地主底牌是什么\n\t\t\tconsole.log(\"我重连成功了\");\t\n\t\t}\n\t\t\n\t},\n    // start () {\n    // },\n\n    /*\n     //通过accountid获取用户出牌放在gamescend的位置 \n     做法：先放3个节点在gameacene的场景中cardsoutzone(012)\n           \n    */\n    getUserOutCardPosByAccount(accountid){\n        console.log(\"getUserOutCardPosByAccount accountid:\"+accountid)\n        for(var i=0;i<this.playerNodeList.length;i++){\n            var node = this.playerNodeList[i]\n            if(node){\n                //获取节点绑定的组件\n                var node_script = node.getComponent(\"player_node\")\n                //如果accountid和player_node节点绑定的accountid相同\n                //接获取player_node的子节点\n                if(node_script.accountid===accountid){\n                  var seat_node = this.players_seat_pos.children[node_script.seat_index]\n                  var index_name = \"cardsoutzone\"+node_script.seat_index\n                  //console.log(\"getUserOutCardPosByAccount index_name:\"+index_name)\n                  var out_card_node = seat_node.getChildByName(index_name)\n                  //console.log(\"OutZone:\"+ out_card_node.name)\n                  return out_card_node\n                }\n            }\n        }\n\n        return null\n    },\n    // update (dt) {},\n});\n"]}